language: C

compiler:
  - gcc

before_install:
  - pip install --user cpp-coveralls
  - git clone https://github.com/connectFree/everip.git
  - git clone https://github.com/connectFree/libre.git
  - git clone https://github.com/connectFree/libsodium.git

install:
  - cd libre
  - STATIC=1 USE_OPENSSL= make
  - cd ../libsodium
  - ./autogen.sh
  - ./configure --prefix=$PWD/../build_libsodium --disable-shared
  - make
  - make install
  - cd ../everip

script:
  - GCOV=1 SIGNED_CLA_LICENSE=1 LIBSODIUM_PATH=../build_libsodium make test

after_success:
  - coveralls --exclude lib --exclude tests --gcov-options '\-lp'
